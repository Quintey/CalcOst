
@model IEnumerable<Truboprovod_V2.Models.OstResShirinaModel>


@{
    ViewBag.Title = "Админка";
    Layout = "~/Views/Shared/_adminLayout.cshtml";
}



@section Scripts {


    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script src="~/Scripts/jquery-ui-1.12.1.min.js"></script>
    <script src="~/Scripts/jquery.jqGrid.min.js"></script>
    <script src="~/Scripts/i18n/grid.locale-ru.js" type="text/javascript"></script>
    <script src="~/Scripts/jquery.jqGrid.src.js"></script>
    <link href="~/Content/themes/base/jquery-ui.min.css" rel="stylesheet" />
    <link href="~/Content/jquery.jqGrid/ui.jqgrid.css" rel="stylesheet" type="text/css" />
}
<style>
    body {
        background-color: #f0f0ffa;
    }

    .ui-jqgrid .ui-pg-input {
        height: 20px;
    }

    .ui-jqgrid .ui-jqgrid-pager {
        height: 50px;
    }


   
</style>
<script type="text/javascript">
    $(document).ready(function () {
    $("#jqg").jqGrid({
        url: '@Url.Action("GetShirinaData")',
        datatype: "json",
        colNames: ['Id', 'Username', 'OstResult', 'Date','Diametr','P','Sreda','Narabotka','Material','Nominal_tolshina','Steel','Rh1','Rh2'],
        colModel: [
            { name: 'Id', index: 'Id', width: 50, stype: 'text' },
            { name: 'UserName', index: 'UserName', width: 150, sortable: true},
            { name: 'OstResult', index: 'OstResult', width: 50, sortable: true},
            { name: 'Date', index: 'Date', width: 80, sortable: true},
            { name: 'Diametr', index: 'Diametr', width: 50, sortable: true},
            { name: 'P', index: 'P', width: 50, sortable: true},
            { name: 'Sreda', index: 'Sreda', width: 80, sortable: true},
            { name: 'Material', index: 'Material', width: 80, sortable: true},
            { name: 'Narabotka', index: 'Narabotka', width: 80, sortable: true},
            { name: 'Nominal_tolshina', index: 'Nominal_tolshina', width: 80, sortable: true},
            { name: 'Steel', index: 'Steel', width: 50, sortable: true},
            { name: 'Rh1', index: 'Rh1', width: 80, sortable: true},
            { name: 'Rh2', index: 'Rh2', width: 80, sortable: true},
        ],
        rowNum: 30, // число отображаемых строк
        loadonce:true, // загрузка только один раз
        sortname: 'Id', // сортировка по умолчанию по столбцу Id
        sortorder: "desc", // порядок сортировки
        caption: "Результаты расчетов",
        rowList: [20, 40, 60],
        pager: '#jpager'
        });
        $("#jqg").jqGrid('navGrid', '#jpager', {

            add: false,
            del: false,
            edit: false,
            search: true,
            searchtext: "Поиск",
            refresh: true,
            refreshtext: "Обновить",
            add: true, // добавление
            del: true, // удаление
            edit: true, // редактирование
            view: true, // просмотр записи
            viewtext: "Смотреть",
            viewtitle: "Выбранная запись",
            addtext: "Добавить",
            edittext: "Изменить",
            deltext: "Удалить"
        },
            update("edit"), // обновление
            update("add"), // добавление
            update("del") // удаление
        );
        function update(act) {
        return {
            closeAfterAdd: true, // закрыть после добавления
            height: 250,
            width: 400,
            closeAfterEdit: true, // закрыть после редактирования
            reloadAfterSubmit: true, // обновление
            drag: true,
            onclickSubmit: function (params) {
                var list = $("#jqg");
                var selectedRow = list.getGridParam("selrow");
                rowData = list.getRowData(selectedRow);
                if (act === "add")
                    params.url= '@Url.Action("Create")';
                else if (act === "del")
                    params.url = '@Url.Action("Delete")';
                else if (act === "edit")
                    params.url = '@Url.Action("Edit")';
            },
            afterSubmit: function (response, postdata) {
                // обновление грида
                $(this).jqGrid('setGridParam', { datatype: 'json' }).trigger('reloadGrid')
                return [true, "", 0]
            }
        };
    };
});
</script>



